<?xml version="1.0" encoding="UTF-8" ?>
<Page
    x:Class="MagiDesk.Frontend.Views.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Toolbar + Connectivity Info -->
        <StackPanel Grid.Row="0" Spacing="6">
            <CommandBar DefaultLabelPosition="Right">
                <AppBarButton x:Name="AddBtn" Icon="Add" Label="Add" Click="Add_Click"/>
                <AppBarButton x:Name="EditBtn" Icon="Edit" Label="Edit" Click="Edit_Click"/>
                <AppBarButton x:Name="DeleteBtn" Icon="Delete" Label="Delete" Click="Delete_Click"/>
                <AppBarButton x:Name="RefreshBtn" Icon="Refresh" Label="Refresh" Click="Refresh_Click"/>
                <AppBarSeparator/>
                <AppBarToggleButton x:Name="DarkToggle" Label="Dark Mode" Click="ThemeToggle_Click"/>
                <AppBarButton x:Name="LogoutBtn" Label="Logout" Click="Logout_Click"/>
            </CommandBar>
            <InfoBar x:Name="BackendInfo"
                     IsOpen="False"
                     Severity="Warning"
                     Message="Backend is unavailable. Features may be limited until connectivity is restored."/>
        </StackPanel>

        <NavigationView Grid.Row="1" x:Name="NavView"
                        ItemInvoked="NavView_ItemInvoked"
                        IsSettingsVisible="False"
                        IsBackButtonVisible="Auto"
                        PaneDisplayMode="Left">
            <NavigationView.MenuItems>
                <!-- Always on top -->
                <NavigationViewItem Content="Dashboard" Tag="DashboardPage" Icon="Home"/>
                <NavigationViewItemSeparator/>

                <!-- Top-level operations -->
                <NavigationViewItem Content="Tables" Tag="TablesPage" Icon="Map"/>
                <NavigationViewItem Content="Orders" Tag="OrdersPage" Icon="Link"/>
                <NavigationViewItem Content="Billing" Tag="BillingPage" Icon="Calendar"/>
                <NavigationViewItem Content="Payments" Tag="PaymentPage" Icon="Shop">
                    <NavigationViewItem.MenuItems>
                        <NavigationViewItem Content="All Payments" Tag="AllPaymentsPage" Icon="List"/>
                    </NavigationViewItem.MenuItems>
                </NavigationViewItem>
                <NavigationViewItem Content="Cash Flow" Tag="CashFlowPage" Icon="Calculator"/>
                <NavigationViewItem Content="Sessions" Tag="SessionsPage" Icon="Sync"/>

                <NavigationViewItemSeparator/>

                <!-- Management Group -->
                <NavigationViewItemHeader Content="Management"/>
                <NavigationViewItem Content="Menu" Tag="MenuPage" Icon="Shop"/>
                <NavigationViewItem Content="Vendors" Tag="VendorsPage" Icon="People">
                    <NavigationViewItem.MenuItems>
                        <NavigationViewItem Content="Vendor-Orders" Tag="VendorOrdersPage" Icon="List"/>
                    </NavigationViewItem.MenuItems>
                </NavigationViewItem>
                <NavigationViewItem Content="Items" Tag="ItemsPage" Icon="Shop"/>
                <NavigationViewItem Content="Inventory" Tag="InventoryPage" Icon="AllApps"/>

                <NavigationViewItemSeparator/>

                <!-- Administration Group -->
                <NavigationViewItemHeader Content="Administration"/>
                <NavigationViewItem x:Name="UsersItem" Content="Users" Tag="UsersPage" Icon="Contact"/>
                <NavigationViewItem Content="Settings" Tag="SettingsPage" Icon="Setting"/>
            </NavigationView.MenuItems>
            <Frame x:Name="ContentFrame"/>
        </NavigationView>

        <!-- Invisible printing panel for CommunityToolkit PrintHelper -->
        <Grid x:Name="PrintingContainer" 
              Opacity="0" 
              IsHitTestVisible="False"
              Grid.RowSpan="2"/>
    </Grid>
</Page>
