<Page
    x:Class="MagiDesk.Frontend.Views.ModernDashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:vm="using:MagiDesk.Frontend.ViewModels"
    xmlns:controls="using:Microsoft.UI.Xaml.Controls"
    xmlns:converters="using:MagiDesk.Frontend.Converters"
    mc:Ignorable="d"
    Background="Transparent">

    <Page.Resources>
        <!-- Converters -->
        <converters:BoolToColorConverter x:Key="BoolToColorConverter" />
        <converters:BoolToStatusConverter x:Key="BoolToStatusConverter" />
        <converters:CountToVisibilityConverter x:Key="CountToVisibilityConverter" />
        <converters:BoolToVisibilityConverter x:Key="BoolToVisibilityConverter" />
        <converters:OccupiedToColorConverter x:Key="OccupiedToColorConverter" />
        <converters:RevenueToHeightConverter x:Key="RevenueToHeightConverter" />
        <converters:OccupancyToHeightConverter x:Key="OccupancyToHeightConverter" />
        <converters:CurrencyConverter x:Key="CurrencyConverter" />
        <converters:PercentageConverter x:Key="PercentageConverter" />
        <converters:TimeAgoConverter x:Key="TimeAgoConverter" />
        <converters:PriorityToColorConverter x:Key="PriorityToColorConverter" />
        <converters:NotificationTypeToIconConverter x:Key="NotificationTypeToIconConverter" />
    </Page.Resources>

    <Grid Background="Transparent">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Page Header (Fluent 2 Style) -->
        <StackPanel Grid.Row="0" Style="{StaticResource FluentPageHeaderStyle}">
            <TextBlock Text="Dashboard" 
                       Style="{StaticResource DisplayTextStyle}"
                       Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
            <TextBlock Text="{Binding LastUpdated}" 
                       Style="{StaticResource CaptionTextStyle}"
                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
        </StackPanel>

        <!-- Connection Status InfoBar -->
        <InfoBar Grid.Row="1"
                 x:Name="ConnectionInfoBar"
                 Visibility="{Binding IsConnected, Converter={StaticResource BoolToVisibilityConverter}, ConverterParameter=Inverted}"
                 Severity="Warning"
                 Style="{StaticResource FluentInfoBarStyle}"
                 Message="Backend is unavailable. Features may be limited until connectivity is restored."
                 Margin="24,0,24,16"/>

        <!-- Main Content Area -->
        <ScrollViewer Grid.Row="2" 
                      ZoomMode="Disabled"
                      Padding="24">
            <Grid Style="{StaticResource FluentContentGridStyle}">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Executive Summary Cards (Metric Cards) -->
                <Grid Grid.Row="0" Style="{StaticResource FluentCardGridStyle}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Revenue Card -->
                    <Border Grid.Column="0" Style="{StaticResource FluentMetricCardStyle}" Margin="0,0,8,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B9;" FontSize="24" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                <TextBlock Text="Revenue Today" 
                                         Style="{StaticResource SubtitleTextStyle}"
                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                            <TextBlock Text="{Binding TodayRevenue, Converter={StaticResource CurrencyConverter}}" 
                                     FontSize="32" 
                                     FontWeight="Bold"
                                     FontFamily="Segoe UI Variable"
                                     Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{Binding SettledRevenue, Converter={StaticResource CurrencyConverter}}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{Binding PendingRevenue, Converter={StaticResource CurrencyConverter}}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Tables Card -->
                    <Border Grid.Column="1" Style="{StaticResource FluentMetricCardStyle}" Margin="8,0,8,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B9;" FontSize="24" Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                                <TextBlock Text="Table Occupancy" 
                                         Style="{StaticResource SubtitleTextStyle}"
                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                            <TextBlock Text="{Binding OccupancyPercentage, Converter={StaticResource PercentageConverter}}" 
                                     FontSize="32" 
                                     FontWeight="Bold"
                                     FontFamily="Segoe UI Variable"
                                     Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{Binding OccupiedTables}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{Binding AvailableTables}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Orders Card -->
                    <Border Grid.Column="2" Style="{StaticResource FluentMetricCardStyle}" Margin="8,0,8,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8A5;" FontSize="24" Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                                <TextBlock Text="Orders Today" 
                                         Style="{StaticResource SubtitleTextStyle}"
                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                            <TextBlock Text="{Binding TotalOrdersToday}" 
                                     FontSize="32" 
                                     FontWeight="Bold"
                                     FontFamily="Segoe UI Variable"
                                     Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{Binding TotalOrderValue, Converter={StaticResource CurrencyConverter}}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{Binding PendingDelivery}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>

                    <!-- Sessions Card -->
                    <Border Grid.Column="3" Style="{StaticResource FluentMetricCardStyle}" Margin="8,0,0,0">
                        <StackPanel Spacing="12">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B9;" FontSize="24" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                <TextBlock Text="Active Sessions" 
                                         Style="{StaticResource SubtitleTextStyle}"
                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                            <TextBlock Text="{Binding ActiveSessions}" 
                                     FontSize="32" 
                                     FontWeight="Bold"
                                     FontFamily="Segoe UI Variable"
                                     Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                            <StackPanel Spacing="4">
                                <TextBlock Text="{Binding SessionsToday}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Text="{Binding AverageSessionMinutes}" 
                                         Style="{StaticResource CaptionTextStyle}"
                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Charts and Analytics Row -->
                <Grid Grid.Row="1" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Revenue Chart Card -->
                    <Border Grid.Column="0" Style="{StaticResource FluentElevatedCardStyle}" Margin="0,0,8,0">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Revenue Trend (7 Days)" 
                                     Style="{StaticResource TitleTextStyle}"
                                     Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            
                            <!-- Simple Bar Chart -->
                            <Grid Height="200">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <!-- Chart Area -->
                                <Grid Grid.Row="0" Margin="0,0,0,8">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    
                                    <!-- Chart Bars -->
                                    <Border Grid.Column="0" 
                                          Background="{ThemeResource AccentFillColorDefaultBrush}" 
                                          Height="{Binding RevenueChartData[0].Revenue, Converter={StaticResource RevenueToHeightConverter}}"
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="1" 
                                          Background="{ThemeResource AccentFillColorDefaultBrush}" 
                                          Height="{Binding RevenueChartData[1].Revenue, Converter={StaticResource RevenueToHeightConverter}}"
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="2" 
                                          Background="{ThemeResource AccentFillColorDefaultBrush}" 
                                          Height="{Binding RevenueChartData[2].Revenue, Converter={StaticResource RevenueToHeightConverter}}"
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="3" 
                                          Background="{ThemeResource SystemFillColorSuccessBrush}" 
                                          Height="{Binding RevenueChartData[3].Revenue, Converter={StaticResource RevenueToHeightConverter}}"
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="4" 
                                          Background="{ThemeResource AccentFillColorDefaultBrush}" 
                                          Height="{Binding RevenueChartData[4].Revenue, Converter={StaticResource RevenueToHeightConverter}}"
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="5" 
                                          Background="{ThemeResource ControlFillColorDefaultBrush}" 
                                          Height="20" 
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                    <Border Grid.Column="6" 
                                          Background="{ThemeResource ControlFillColorDefaultBrush}" 
                                          Height="20" 
                                          VerticalAlignment="Bottom" 
                                          CornerRadius="4,4,0,0"/>
                                </Grid>
                                
                                <!-- Chart Labels -->
                                <StackPanel Grid.Row="1" 
                                          Orientation="Horizontal" 
                                          HorizontalAlignment="Center" 
                                          Spacing="0">
                                    <TextBlock Text="M" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="T" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="W" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="T" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="F" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="S" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                    <TextBlock Text="S" Width="40" TextAlignment="Center" 
                                             Style="{StaticResource CaptionTextStyle}"
                                             Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Border>

                    <!-- Server Performance Card -->
                    <Border Grid.Column="1" Style="{StaticResource FluentElevatedCardStyle}" Margin="8,0,0,0">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Server Performance" 
                                     Style="{StaticResource TitleTextStyle}"
                                     Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            
                            <ListView ItemsSource="{Binding ServerPerformance}" 
                                    SelectionMode="None"
                                    Style="{StaticResource FluentListViewStyle}">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Spacing="{StaticResource Spacing8}">
                                            <StackPanel Orientation="Horizontal" Spacing="8">
                                                <TextBlock Text="{Binding ServerName}" 
                                                         Style="{StaticResource SubtitleTextStyle}"
                                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                                <TextBlock Text="{Binding RevenueGenerated, Converter={StaticResource CurrencyConverter}}"
                                                         Style="{StaticResource CaptionTextStyle}"
                                                         Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                            </StackPanel>
                                            
                                            <ProgressBar Value="{Binding PerformancePercentage}" 
                                                       Maximum="100" 
                                                       Style="{StaticResource FluentProgressBarStyle}"/>
                                            
                                            <StackPanel Orientation="Horizontal" Spacing="{StaticResource Spacing16}">
                                                <TextBlock Text="{Binding SessionsToday}" 
                                                         Style="{StaticResource CaptionTextStyle}"
                                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                                <TextBlock Text="{Binding AverageSessionMinutes}" 
                                                         Style="{StaticResource CaptionTextStyle}"
                                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                            </StackPanel>
                                        </StackPanel>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Live Operations Row -->
                <Grid Grid.Row="2" Margin="0,0,0,16">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Live Table Status Card -->
                    <Border Grid.Column="0" Style="{StaticResource FluentCardStyle}" Margin="0,0,8,0">
                        <StackPanel Spacing="16">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B9;" FontSize="20" Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
                                <TextBlock Text="Live Table Status" 
                                         Style="{StaticResource SubtitleTextStyle}"
                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                <Ellipse Width="8" Height="8" Fill="{ThemeResource SystemFillColorSuccessBrush}"/>
                            </StackPanel>
                            
                            <!-- Tables Grid -->
                            <ItemsControl ItemsSource="{Binding Tables}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapGrid Orientation="Horizontal" MaximumRowsOrColumns="5"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Border Background="{Binding Occupied, Converter={StaticResource OccupiedToColorConverter}}" 
                                              CornerRadius="6" 
                                              Padding="8,6" 
                                              Margin="2"
                                              Width="100"
                                              Height="50">
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="{Binding Label}" 
                                                         FontWeight="SemiBold" 
                                                         FontSize="12"
                                                         HorizontalAlignment="Center" 
                                                         Foreground="White"
                                                         TextTrimming="CharacterEllipsis"/>
                                                <TextBlock Text="{Binding Type}" 
                                                         FontSize="9"
                                                         HorizontalAlignment="Center" 
                                                         Foreground="White"
                                                         Opacity="0.85"
                                                         TextTrimming="CharacterEllipsis"/>
                                            </StackPanel>
                                        </Border>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </Border>

                    <!-- Active Sessions Card -->
                    <Border Grid.Column="1" Style="{StaticResource FluentCardStyle}" Margin="8,0,0,0">
                        <StackPanel Spacing="16">
                            <TextBlock Text="Active Sessions &amp; Reminders" 
                                     Style="{StaticResource SubtitleTextStyle}"
                                     Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            
                            <!-- Active Sessions -->
                            <TextBlock Text="Active Sessions" 
                                     Style="{StaticResource BodyTextStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <ListView ItemsSource="{Binding ActiveSessionsList}" 
                                    SelectionMode="None" 
                                    Height="120"
                                    Style="{StaticResource FluentListViewStyle}">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0" Spacing="{StaticResource Spacing4}">
                                                <TextBlock Text="{Binding TableId}" 
                                                         Style="{StaticResource BodyTextStyle}"
                                                         FontWeight="SemiBold"
                                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                                <TextBlock Text="{Binding ServerName}" 
                                                         Style="{StaticResource CaptionTextStyle}"
                                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Column="1" 
                                                     Text="{Binding StartTime, Converter={StaticResource TimeAgoConverter}}" 
                                                     Style="{StaticResource CaptionTextStyle}"
                                                     Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                            
                            <!-- Reminders -->
                            <TextBlock Text="Reminders" 
                                     Style="{StaticResource BodyTextStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <ListView ItemsSource="{Binding Reminders}" 
                                    SelectionMode="None" 
                                    Height="100"
                                    Style="{StaticResource FluentListViewStyle}">
                                <ListView.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0" Spacing="{StaticResource Spacing4}">
                                                <TextBlock Text="{Binding Title}" 
                                                         Style="{StaticResource BodyTextStyle}"
                                                         FontWeight="SemiBold"
                                                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                                <TextBlock Text="{Binding Description}" 
                                                         Style="{StaticResource CaptionTextStyle}"
                                                         Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                            </StackPanel>
                                            
                                            <TextBlock Grid.Column="1" 
                                                     Text="{Binding DueTime, Converter={StaticResource TimeAgoConverter}}"
                                                     Style="{StaticResource CaptionTextStyle}"
                                                     Foreground="{ThemeResource SystemFillColorCautionBrush}"/>
                                        </Grid>
                                    </DataTemplate>
                                </ListView.ItemTemplate>
                            </ListView>
                        </StackPanel>
                    </Border>
                </Grid>

                <!-- Quick Actions Card -->
                <Border Grid.Row="3" Style="{StaticResource FluentCardStyle}">
                    <StackPanel Spacing="{StaticResource Spacing16}">
                        <TextBlock Text="Quick Actions" 
                                 Style="{StaticResource SubtitleTextStyle}"
                                 Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                            
                            <Button Grid.Column="0" 
                                  Content="Start Session" 
                                  Style="{StaticResource FluentPrimaryButtonStyle}"
                                  Margin="0,0,4,0"
                                  Click="StartSession_Click"/>
                            <Button Grid.Column="1" 
                                  Content="View Orders" 
                                  Style="{StaticResource FluentPrimaryButtonStyle}"
                                  Margin="4,0,4,0"
                                  Click="ViewOrders_Click"/>
                            <Button Grid.Column="2" 
                                  Content="Generate Report" 
                                  Style="{StaticResource FluentSecondaryButtonStyle}"
                                  Margin="4,0,4,0"
                                  Click="GenerateReport_Click"/>
                            <Button Grid.Column="3" 
                                  Content="Settings" 
                                  Style="{StaticResource FluentSecondaryButtonStyle}"
                                  Margin="4,0,0,0"
                                  Click="OpenSettings_Click"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
        </ScrollViewer>

        <!-- Loading Overlay -->
        <Grid Grid.RowSpan="3" 
              Background="{ThemeResource SystemFillColorAttentionBackground}" 
              Opacity="0.8"
              Visibility="{Binding IsLoading, Converter={StaticResource BoolToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center" Spacing="16">
                <ProgressRing IsActive="True" 
                            Width="40" 
                            Height="40" 
                            Foreground="{ThemeResource AccentFillColorDefaultBrush}"/>
                <TextBlock Text="Loading dashboard data..." 
                         Style="{StaticResource BodyTextStyle}"
                         Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
            </StackPanel>
        </Grid>
    </Grid>
</Page>
