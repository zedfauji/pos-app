<?xml version="1.0" encoding="utf-8"?>
<ContentDialog
    x:Class="MagiDesk.Frontend.Views.ComboEditDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Create/Edit Combo Deal"
    PrimaryButtonText="Save"
    SecondaryButtonText="Cancel"
    DefaultButton="Primary">

    <ScrollViewer MaxHeight="600" MaxWidth="500">
        <StackPanel Spacing="16" Padding="4">
            <!-- Basic Information -->
            <StackPanel Spacing="8">
                <TextBlock Text="Combo Information" FontWeight="SemiBold" FontSize="16"/>
                
                <TextBox x:Name="NameTextBox" 
                         Header="Combo Name*" 
                         PlaceholderText="e.g., Burger Combo"/>
                
                <TextBox x:Name="DescriptionTextBox" 
                         Header="Description" 
                         PlaceholderText="e.g., Burger + Fries + Drink"
                         AcceptsReturn="True"
                         Height="60"/>
            </StackPanel>

            <!-- Items in Combo -->
            <StackPanel Spacing="8">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <TextBlock Grid.Column="0" Text="Items in Combo" FontWeight="SemiBold" FontSize="16"/>
                    <Button Grid.Column="1" Content="➕ Add Item" 
                            Click="AddItem_Click"
                            Style="{StaticResource AccentButtonStyle}"/>
                </Grid>
                
                <ListView x:Name="ComboItemsList" 
                          Height="200"
                          BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                          BorderThickness="1"
                          CornerRadius="6">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="12,8">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding ItemName}" FontWeight="SemiBold"/>
                                    <TextBlock FontSize="12" Foreground="{ThemeResource TextFillColorSecondaryBrush}">
                                        <Run Text="Qty:"/>
                                        <Run Text="{Binding Quantity}"/>
                                        <Run Text=" • Price: $"/>
                                        <Run Text="{Binding Price}"/>
                                    </TextBlock>
                                </StackPanel>

                                <CheckBox Grid.Column="1" 
                                          Content="Required" 
                                          IsChecked="{Binding IsRequired}"
                                          Margin="8,0"/>

                                <Button Grid.Column="2" Content="✏️" 
                                        Width="28" Height="28"
                                        Click="EditItem_Click"
                                        Tag="{Binding}"
                                        ToolTipService.ToolTip="Edit Item"/>

                                <Button Grid.Column="3" Content="🗑️" 
                                        Width="28" Height="28"
                                        Click="RemoveItem_Click"
                                        Tag="{Binding}"
                                        ToolTipService.ToolTip="Remove Item"/>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </StackPanel>

            <!-- Pricing -->
            <StackPanel Spacing="8">
                <TextBlock Text="Pricing" FontWeight="SemiBold" FontSize="16"/>
                
                <NumberBox x:Name="OriginalPriceNumberBox" 
                           Header="Original Price ($)*"
                           Minimum="0.01"
                           SpinButtonPlacementMode="Inline"
                           ValueChanged="PriceNumberBox_ValueChanged"/>
                
                <NumberBox x:Name="ComboPriceNumberBox" 
                           Header="Combo Price ($)*"
                           Minimum="0.01"
                           SpinButtonPlacementMode="Inline"
                           ValueChanged="PriceNumberBox_ValueChanged"/>
                
                <TextBlock x:Name="SavingsText" 
                           Text="Savings: $0.00"
                           FontWeight="SemiBold"
                           Foreground="{ThemeResource SystemFillColorSuccessBrush}"/>
            </StackPanel>

            <!-- Validity Period -->
            <StackPanel Spacing="8">
                <TextBlock Text="Validity Period" FontWeight="SemiBold" FontSize="16"/>
                
                <DatePicker x:Name="StartDatePicker" 
                            Header="Start Date*"/>
                
                <DatePicker x:Name="EndDatePicker" 
                            Header="End Date*"/>
            </StackPanel>

            <!-- Settings -->
            <StackPanel Spacing="8">
                <TextBlock Text="Settings" FontWeight="SemiBold" FontSize="16"/>
                
                <CheckBox x:Name="IsActiveCheckBox" 
                          Content="Active" 
                          IsChecked="True"/>
                
                <CheckBox x:Name="AllowSubstitutionsCheckBox" 
                          Content="Allow item substitutions"/>
            </StackPanel>

            <!-- Preview -->
            <Border Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="6"
                    Padding="12">
                <StackPanel Spacing="4">
                    <TextBlock Text="Combo Preview" FontWeight="SemiBold" FontSize="14"/>
                    <TextBlock x:Name="PreviewText" 
                               Text="Add items to see preview"
                               FontSize="12"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
