<Page
    x:Class="MagiDesk.Frontend.Views.SettingsPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">
    <Grid Padding="24">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="220"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>

        <!-- Left menu (vertical tabs) -->
        <StackPanel Grid.Column="0" Spacing="8">
            <TextBlock x:Name="TitleText" Text="Settings" FontSize="24" FontWeight="SemiBold"/>
            <ListView x:Name="CategoryList" SelectionChanged="CategoryList_SelectionChanged">
                <ListViewItem Content="General"/>
                <ListViewItem Content="Connections"/>
                <ListViewItem Content="Billing &amp; Printing"/>
                <ListViewItem Content="Tables"/>
            </ListView>
        </StackPanel>

        <!-- Right content -->
        <Grid Grid.Column="1">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <ProgressRing x:Name="LoadingRing" IsActive="False" Visibility="Collapsed"/>

            <ScrollViewer Grid.Row="1">
                <StackPanel Spacing="12" Width="640">
                    <!-- General -->
                    <StackPanel x:Name="GeneralPanel" Spacing="8">
                        <TextBlock Text="General" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock Text="Store Name / Host Key" FontWeight="SemiBold"/>
                        <TextBox x:Name="SettingsHostText" PlaceholderText="store-1"/>
                        <TextBlock Text="Main UI Settings" FontWeight="SemiBold" Margin="0,8,0,0"/>
                        <TextBlock x:Name="ThemeLabel" Text="Theme"/>
                        <ComboBox x:Name="ThemeSelector" SelectedIndex="0">
                            <ComboBoxItem Content="System"/>
                            <ComboBoxItem Content="Dark"/>
                            <ComboBoxItem Content="Light"/>
                        </ComboBox>
                        <TextBlock x:Name="ThemeHint" Text="System uses Windows theme" Opacity="0.7" FontSize="12"/>
                        <TextBlock x:Name="ThemeSummaryText" Text="Theme: -"/>
                        <TextBlock x:Name="AppSummaryText" Text="App Settings: -"/>
                    </StackPanel>

                    <!-- Connections -->
                    <StackPanel x:Name="ConnectionsPanel" Spacing="8" Visibility="Collapsed">
                        <TextBlock Text="Connections" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock x:Name="BackendUrlLabel" Text="Backend Base URL"/>
                        <TextBox x:Name="BaseUrlText" PlaceholderText="https://localhost:7016"/>
                        <TextBlock Text="Settings API URL"/>
                        <TextBox x:Name="SettingsApiUrlText" PlaceholderText="https://.../settings"/>
                        <TextBlock Text="Tables API URL"/>
                        <TextBox x:Name="TablesApiUrlText" PlaceholderText="https://.../tables"/>

                        <StackPanel Spacing="6">
                            <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                                <Ellipse x:Name="BackendStatusDot" Width="10" Height="10" Fill="Gray" VerticalAlignment="Center"/>
                                <TextBlock x:Name="BackendSummaryText" Text="Backend: -"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                                <Ellipse x:Name="SettingsStatusDot" Width="10" Height="10" Fill="Gray" VerticalAlignment="Center"/>
                                <TextBlock x:Name="SettingsStatusText" Text="Settings API: -"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="6" VerticalAlignment="Center">
                                <Ellipse x:Name="TablesStatusDot" Width="10" Height="10" Fill="Gray" VerticalAlignment="Center"/>
                                <TextBlock x:Name="TablesStatusText" Text="Tables API: -"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>

                    <!-- Billing & Printing -->
                    <StackPanel x:Name="BillingPanel" Spacing="8" Visibility="Collapsed">
                        <TextBlock Text="Billing &amp; Printing" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock Text="Printer Settings" FontWeight="SemiBold"/>
                        <StackPanel Orientation="Horizontal" Spacing="12">
                            <StackPanel>
                                <TextBlock Text="Paper Width"/>
                                <ComboBox x:Name="PrinterWidthCombo" SelectedIndex="0" Width="120">
                                    <ComboBoxItem Content="58 mm" Tag="58"/>
                                    <ComboBoxItem Content="80 mm" Tag="80"/>
                                </ComboBox>
                            </StackPanel>
                            <StackPanel>
                                <TextBlock Text="Tax %"/>
                                <TextBox x:Name="TaxPercentText" PlaceholderText="8.5" Width="100"/>
                            </StackPanel>
                        </StackPanel>
                        <TextBlock Text="Actions" FontWeight="SemiBold"/>
                    </StackPanel>

                    <!-- Tables -->
                    <StackPanel x:Name="TablesPanel" Spacing="8" Visibility="Collapsed">
                        <TextBlock Text="Tables" FontSize="18" FontWeight="SemiBold"/>
                        <TextBlock x:Name="CurrentRateText" Text="Current Rate: -"/>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>

            <!-- Bottom actions per category -->
            <StackPanel Grid.Row="2" Orientation="Horizontal" Spacing="12">
                <Button x:Name="SaveButton" Content="Save" Click="Save_Click"/>
                <Button x:Name="SaveApiButton" Content="Save API URLs" Click="SaveApi_Click"/>
                <Button x:Name="PingApisButton" Content="Refresh Status" Click="PingApis_Click"/>
                <Button x:Name="TestPrintButton" Content="Print test receipt" Click="TestPrint_Click"/>
                <Button x:Name="EditAppSettingsButton" Content="Reset to Defaults" Click="EditAppSettings_Click"/>
            </StackPanel>

            <TextBlock x:Name="StatusText" Grid.Row="2" HorizontalAlignment="Right"/>
        </Grid>
    </Grid>
</Page>
