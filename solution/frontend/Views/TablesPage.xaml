<Page
    x:Class="MagiDesk.Frontend.Views.TablesPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:local="using:MagiDesk.Frontend.Views"
    xmlns:conv="using:MagiDesk.Frontend.Converters"
    xmlns:controls="using:MagiDesk.Frontend.Controls"
    mc:Ignorable="d">
    <Page.Resources>
        <conv:BoolToVisibilityConverter x:Key="BoolToVisibility"/>
        <conv:OccupiedToColorConverter x:Key="OccupiedToColorConverter"/>
        <conv:StringEqualsConverter x:Key="StringEqualsConverter"/>
        
        <!-- Easing Functions -->
        <CubicEase x:Key="CubicEase" EasingMode="EaseOut"/>
    </Page.Resources>
    
    <Grid Background="Transparent">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="240" MinWidth="200"/>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="280" MinWidth="240"/>
        </Grid.ColumnDefinitions>
        
        <!-- Left: Floors Navigation -->
        <Border Grid.Column="0" 
                Background="{StaticResource AcrylicCardBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="0,0,1,0">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <!-- Floors Header -->
                <StackPanel Grid.Row="0" 
                             Padding="16"
                             Background="{ThemeResource ControlFillColorDefaultBrush}">
                    <TextBlock Text="Floors" 
                               Style="{StaticResource TitleTextStyle}"
                               Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    <TextBlock Text="Select a floor to view tables" 
                               Style="{StaticResource CaptionTextStyle}"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,4,0,0"/>
                </StackPanel>
                
                <!-- Floors List -->
                <ListView Grid.Row="1"
                           x:Name="FloorsListView"
                           ItemsSource="{Binding Floors}"
                           SelectedItem="{Binding SelectedFloor, Mode=TwoWay}"
                           SelectionMode="Single"
                           SelectionChanged="FloorsListView_SelectionChanged"
                           Style="{StaticResource FluentListViewStyle}">
                    <ListView.ItemTemplate>
                        <DataTemplate>
                            <Grid Padding="12,8" Margin="8,4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                
                                <StackPanel Grid.Column="0">
                                    <TextBlock Text="{Binding FloorName}" 
                                               FontWeight="SemiBold"
                                               Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                                    <TextBlock Text="{Binding Description}" 
                                               Style="{StaticResource CaptionTextStyle}"
                                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                               TextTrimming="CharacterEllipsis"
                                               MaxLines="2"/>
                                </StackPanel>
                                
                                <StackPanel Grid.Column="1" 
                                            Orientation="Horizontal" 
                                            Spacing="4"
                                            VerticalAlignment="Center">
                                    <Border Background="{ThemeResource SystemFillColorAttentionBackground}"
                                            CornerRadius="4"
                                            Padding="4,2"
                                            Visibility="{Binding IsDefault, Converter={StaticResource BoolToVisibility}}">
                                        <TextBlock Text="Default" 
                                                   FontSize="10"
                                                   Foreground="White"
                                                   FontWeight="SemiBold"/>
                                    </Border>
                                    <Border Background="{ThemeResource SystemFillColorSuccessBackground}"
                                            CornerRadius="4"
                                            Padding="4,2"
                                            Visibility="{Binding IsActive, Converter={StaticResource BoolToVisibility}}">
                                        <TextBlock Text="Active" 
                                                   FontSize="10"
                                                   Foreground="White"
                                                   FontWeight="SemiBold"/>
                                    </Border>
                                </StackPanel>
                            </Grid>
                        </DataTemplate>
                    </ListView.ItemTemplate>
                </ListView>
            </Grid>
        </Border>
        
        <!-- Center: Layout Preview (Full Screen) -->
        <Grid Grid.Column="1" Margin="16">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            
            <!-- Compact Header -->
            <Grid Grid.Row="0" Margin="0,0,0,12">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0">
                    <TextBlock Text="Floor Layout Preview" 
                               FontSize="20" FontWeight="SemiBold"
                               Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                    <TextBlock Text="Visual representation of table positions" 
                               FontSize="12"
                               Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                               Margin="0,4,0,0"/>
                </StackPanel>
                
                <!-- Compact Controls -->
                <StackPanel Grid.Column="1" Orientation="Horizontal" Spacing="12" VerticalAlignment="Center">
                    <ComboBox x:Name="FilterCombo" 
                              Width="160" 
                              SelectionChanged="FilterCombo_SelectionChanged"
                              Style="{StaticResource FluentComboBoxStyle}">
                        <ComboBoxItem Content="All Tables"/>
                        <ComboBoxItem Content="Available Only"/>
                        <ComboBoxItem Content="Occupied Only"/>
                    </ComboBox>
                    <ToggleSwitch x:Name="LiveToggle" 
                                  Toggled="LiveToggle_Toggled"
                                  OnContent="Live"
                                  OffContent="Paused"/>
                </StackPanel>
            </Grid>
            
            <!-- Layout Preview Control - Fills remaining space -->
            <Border Grid.Row="1"
                    Background="{ThemeResource SolidBackgroundFillColorBaseBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="12"
                    Padding="8">
                <controls:FloorLayoutPreviewControl x:Name="LayoutPreviewControl"
                                                     TableClicked="LayoutPreviewControl_TableClicked"
                                                     StartSessionRequested="LayoutPreviewControl_StartSessionRequested"
                                                     StopSessionRequested="LayoutPreviewControl_StopSessionRequested"
                                                     OpenTableRequested="LayoutPreviewControl_OpenTableRequested"
                                                     CloseTableRequested="LayoutPreviewControl_CloseTableRequested"
                                                     AddItemsRequested="LayoutPreviewControl_AddItemsRequested"
                                                     CheckSummaryRequested="LayoutPreviewControl_CheckSummaryRequested"
                                                     MoveTableRequested="LayoutPreviewControl_MoveTableRequested"
                                                     AssignToBilliardRequested="LayoutPreviewControl_AssignToBilliardRequested"
                                                     TableStatusRequested="LayoutPreviewControl_TableStatusRequested"
                                                     SetThresholdRequested="LayoutPreviewControl_SetThresholdRequested"
                                                     ClearThresholdRequested="LayoutPreviewControl_ClearThresholdRequested"
                                                     DiagnosticsRequested="LayoutPreviewControl_DiagnosticsRequested"/>
            </Border>
        </Grid>
        
        <!-- Right: Settings Sidebar -->
        <Border Grid.Column="2" 
                Background="{StaticResource AcrylicCardBrush}"
                BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                BorderThickness="1,0,0,0">
            <ScrollViewer VerticalScrollBarVisibility="Auto" Padding="16">
                <StackPanel Spacing="20">
                    <!-- Settings Header -->
                    <StackPanel>
                        <TextBlock Text="Layout Settings" 
                                   FontSize="18" FontWeight="SemiBold"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        <TextBlock Text="Customize layout display" 
                                   FontSize="12"
                                   Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                   Margin="0,4,0,0"/>
                    </StackPanel>
                    
                    <!-- Visibility Options -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Visibility" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        
                        <ToggleSwitch x:Name="ShowFloorLayoutToggle"
                                      Header="Show Floor Layout"
                                      IsOn="True"
                                      Toggled="ShowFloorLayoutToggle_Toggled"/>
                        
                        <ToggleSwitch x:Name="ShowTableLabelsToggle"
                                      Header="Show Table Labels"
                                      IsOn="True"
                                      Toggled="ShowTableLabelsToggle_Toggled"/>
                        
                        <ToggleSwitch x:Name="ShowAvailabilityColorToggle"
                                      Header="Show Availability Color"
                                      IsOn="True"
                                      Toggled="ShowAvailabilityColorToggle_Toggled"/>
                        
                        <ToggleSwitch x:Name="ShowShapesOnlyToggle"
                                      Header="Shapes Only"
                                      IsOn="False"
                                      Toggled="ShowShapesOnlyToggle_Toggled"/>
                    </StackPanel>
                    
                    <!-- Display Options -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Display" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        
                        <ToggleSwitch x:Name="ShowGridToggle"
                                      Header="Show Grid Background"
                                      IsOn="False"
                                      Toggled="ShowGridToggle_Toggled"/>
                        
                        <StackPanel Spacing="8" Margin="0,8,0,0">
                            <TextBlock Text="Zoom Level"
                                       FontSize="12"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <Slider x:Name="ZoomSlider"
                                    Minimum="0.25"
                                    Maximum="2.0"
                                    StepFrequency="0.05"
                                    TickFrequency="0.25"
                                    Value="1.0"
                                    ValueChanged="ZoomSlider_ValueChanged"/>
                            <TextBlock x:Name="ZoomValueText"
                                       Text="100%"
                                       FontSize="11"
                                       Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                       HorizontalAlignment="Right"/>
                        </StackPanel>
                    </StackPanel>
                    
                    <!-- Actions -->
                    <StackPanel Spacing="12">
                        <TextBlock Text="Actions" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        
                        <Button Content="Auto Fit Tables"
                                Click="AutoFitTablesButton_Click"
                                Style="{StaticResource FluentPrimaryButtonStyle}"/>
                        
                        <Button Content="Center Layout"
                                Click="CenterLayoutButton_Click"
                                Style="{StaticResource FluentSecondaryButtonStyle}"/>
                        
                        <Button Content="Reset Zoom"
                                Click="ResetZoomButton_Click"
                                Style="{StaticResource FluentSecondaryButtonStyle}"/>
                    </StackPanel>
                    
                    <!-- Status Info -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Status" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        <Border Style="{StaticResource FluentStatusBadgeStyle}">
                            <TextBlock x:Name="SourceText" 
                                       Foreground="White" 
                                       FontSize="12" FontWeight="SemiBold"/>
                        </Border>
                        <Border Style="{StaticResource FluentStatusBadgeStyle}">
                            <TextBlock x:Name="CountsText" 
                                       Foreground="White" 
                                       FontSize="12" FontWeight="SemiBold"/>
                        </Border>
                    </StackPanel>
                    
                    <!-- Legend -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Legend" 
                                   FontWeight="SemiBold"
                                   FontSize="14"
                                   Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                        <StackPanel Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="{ThemeResource SystemFillColorSuccessBrush}"/>
                                <TextBlock Text="Available" FontSize="12" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Spacing="8" VerticalAlignment="Center">
                                <Border Width="12" Height="12" CornerRadius="6"
                                        Background="{ThemeResource SystemFillColorCriticalBrush}"/>
                                <TextBlock Text="Occupied" FontSize="12" Foreground="{ThemeResource TextFillColorPrimaryBrush}"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </StackPanel>
            </ScrollViewer>
        </Border>
    </Grid>
</Page> 
