<ContentDialog
    x:Class="MagiDesk.Frontend.Views.CampaignEditDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MagiDesk.Frontend.Views"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Campaign Details"
    PrimaryButtonText="Save"
    CloseButtonText="Cancel"
    DefaultButton="Primary"
    IsPrimaryButtonEnabled="{x:Bind IsFormValid, Mode=OneWay}"
    MaxWidth="800"
    MaxHeight="700">

    <ScrollViewer>
        <StackPanel Spacing="20" Padding="4">
            <!-- Basic Information -->
            <StackPanel Spacing="12">
                <TextBlock Text="Basic Information" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <TextBox x:Name="NameTextBox"
                         Header="Campaign Name"
                         PlaceholderText="Enter campaign name"
                         Text="{x:Bind CampaignName, Mode=TwoWay}"
                         TextChanged="OnFormFieldChanged"/>
                
                <TextBox x:Name="DescriptionTextBox"
                         Header="Description"
                         PlaceholderText="Enter campaign description"
                         Text="{x:Bind CampaignDescription, Mode=TwoWay}"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         Height="80"
                         TextChanged="OnFormFieldChanged"/>
            </StackPanel>

            <!-- Campaign Configuration -->
            <StackPanel Spacing="12">
                <TextBlock Text="Campaign Configuration" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <ComboBox x:Name="CampaignTypeComboBox"
                              Grid.Column="0"
                              Header="Campaign Type"
                              HorizontalAlignment="Stretch"
                              SelectedIndex="{x:Bind SelectedCampaignTypeIndex, Mode=TwoWay}"
                              SelectionChanged="OnFormFieldChanged">
                        <ComboBoxItem Content="Discount"/>
                        <ComboBoxItem Content="Loyalty"/>
                        <ComboBoxItem Content="Wallet"/>
                        <ComboBoxItem Content="FreeItem"/>
                        <ComboBoxItem Content="Upgrade"/>
                    </ComboBox>
                    
                    <ComboBox x:Name="ChannelComboBox"
                              Grid.Column="2"
                              Header="Communication Channel"
                              HorizontalAlignment="Stretch"
                              SelectedIndex="{x:Bind SelectedChannelIndex, Mode=TwoWay}"
                              SelectionChanged="OnFormFieldChanged">
                        <ComboBoxItem Content="Email"/>
                        <ComboBoxItem Content="SMS"/>
                        <ComboBoxItem Content="WhatsApp"/>
                        <ComboBoxItem Content="InApp"/>
                    </ComboBox>
                </Grid>

                <ComboBox x:Name="TargetSegmentComboBox"
                          Header="Target Segment"
                          PlaceholderText="Select target segment (optional)"
                          HorizontalAlignment="Stretch"
                          SelectedIndex="{x:Bind SelectedSegmentIndex, Mode=TwoWay}"
                          SelectionChanged="OnFormFieldChanged"/>
            </StackPanel>

            <!-- Campaign Schedule -->
            <StackPanel Spacing="12">
                <TextBlock Text="Campaign Schedule" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <DatePicker x:Name="StartDatePicker"
                                Grid.Column="0"
                                Header="Start Date"
                                HorizontalAlignment="Stretch"
                                DateChanged="OnFormFieldChanged"/>
                    
                    <DatePicker x:Name="EndDatePicker"
                                Grid.Column="2"
                                Header="End Date (Optional)"
                                HorizontalAlignment="Stretch"
                                DateChanged="OnFormFieldChanged"/>
                </Grid>

                <CheckBox x:Name="IsActiveCheckBox"
                          Content="Campaign is active"
                          IsChecked="{x:Bind IsActive, Mode=TwoWay}"
                          Checked="OnFormFieldChanged"
                          Unchecked="OnFormFieldChanged"/>
            </StackPanel>

            <!-- Campaign Rules -->
            <StackPanel Spacing="12">
                <TextBlock Text="Campaign Rules" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="16"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>
                    
                    <NumberBox x:Name="MaxRedemptionsNumberBox"
                               Grid.Column="0"
                               Header="Max Redemptions per Customer"
                               PlaceholderText="Unlimited"
                               Minimum="1"
                               Maximum="1000"
                               Value="{x:Bind MaxRedemptions, Mode=TwoWay}"
                               ValueChanged="OnFormFieldChanged"/>
                    
                    <NumberBox x:Name="MinOrderValueNumberBox"
                               Grid.Column="2"
                               Header="Minimum Order Value"
                               PlaceholderText="No minimum"
                               Minimum="0"
                               Maximum="10000"
                               Value="{x:Bind MinOrderValue, Mode=TwoWay}"
                               ValueChanged="OnFormFieldChanged"/>
                </Grid>
            </StackPanel>

            <!-- Campaign Content -->
            <StackPanel Spacing="12">
                <TextBlock Text="Campaign Content" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <TextBox x:Name="MessageTemplateTextBox"
                         Header="Message Template"
                         PlaceholderText="Enter the message template for this campaign"
                         Text="{x:Bind MessageTemplate, Mode=TwoWay}"
                         TextWrapping="Wrap"
                         AcceptsReturn="True"
                         Height="100"
                         TextChanged="OnFormFieldChanged"/>
                
                <TextBlock Text="Available placeholders: {CustomerName}, {OfferValue}, {ExpiryDate}" 
                           Style="{ThemeResource CaptionTextBlockStyle}"
                           Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
            </StackPanel>

            <!-- Campaign Value Configuration -->
            <StackPanel Spacing="12" x:Name="ValueConfigurationPanel">
                <TextBlock Text="Offer Configuration" 
                           Style="{ThemeResource SubtitleTextBlockStyle}"
                           Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                
                <!-- Discount Configuration -->
                <StackPanel x:Name="DiscountConfigPanel" Spacing="8" Visibility="Collapsed">
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <ComboBox x:Name="DiscountTypeComboBox"
                                  Grid.Column="0"
                                  Header="Discount Type"
                                  HorizontalAlignment="Stretch"
                                  SelectedIndex="0"
                                  SelectionChanged="OnFormFieldChanged">
                            <ComboBoxItem Content="Percentage"/>
                            <ComboBoxItem Content="Fixed Amount"/>
                        </ComboBox>
                        
                        <NumberBox x:Name="DiscountValueNumberBox"
                                   Grid.Column="2"
                                   Header="Discount Value"
                                   Minimum="0"
                                   Maximum="100"
                                   Value="{x:Bind DiscountValue, Mode=TwoWay}"
                                   ValueChanged="OnFormFieldChanged"/>
                    </Grid>
                </StackPanel>

                <!-- Loyalty Points Configuration -->
                <StackPanel x:Name="LoyaltyConfigPanel" Spacing="8" Visibility="Collapsed">
                    <NumberBox x:Name="LoyaltyPointsNumberBox"
                               Header="Loyalty Points to Award"
                               Minimum="1"
                               Maximum="10000"
                               Value="{x:Bind LoyaltyPoints, Mode=TwoWay}"
                               ValueChanged="OnFormFieldChanged"/>
                </StackPanel>

                <!-- Wallet Credit Configuration -->
                <StackPanel x:Name="WalletConfigPanel" Spacing="8" Visibility="Collapsed">
                    <NumberBox x:Name="WalletCreditNumberBox"
                               Header="Wallet Credit Amount"
                               Minimum="0.01"
                               Maximum="1000"
                               Value="{x:Bind WalletCredit, Mode=TwoWay}"
                               ValueChanged="OnFormFieldChanged"/>
                </StackPanel>

                <!-- Free Item Configuration -->
                <StackPanel x:Name="FreeItemConfigPanel" Spacing="8" Visibility="Collapsed">
                    <ComboBox x:Name="FreeItemComboBox"
                              Header="Free Item"
                              PlaceholderText="Select item to offer for free"
                              HorizontalAlignment="Stretch"
                              SelectionChanged="OnFormFieldChanged"/>
                </StackPanel>
            </StackPanel>

            <!-- Validation Messages -->
            <InfoBar x:Name="ValidationInfoBar"
                     Severity="Error"
                     IsOpen="False"
                     Message="Please fill in all required fields"/>
        </StackPanel>
    </ScrollViewer>
</ContentDialog>
