<ContentDialog
    x:Class="MagiDesk.Frontend.Dialogs.SessionRecoveryDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:MagiDesk.Frontend.Dialogs"
    Title="Session Recovery"
    PrimaryButtonText="Resume Selected"
    SecondaryButtonText="Close All"
    CloseButtonText="Cancel"
    DefaultButton="Primary">

    <Grid MinWidth="600" MinHeight="400">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,16">
            <TextBlock Text="Active Sessions Found" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,8"/>
            <TextBlock Text="The following sessions were active when the app last closed. You can resume any session or close all of them." 
                       TextWrapping="Wrap" Foreground="{ThemeResource SystemAccentColor}" Margin="0,0,0,8"/>
            <TextBlock x:Name="SessionCountText" FontWeight="SemiBold"/>
        </StackPanel>

        <!-- Sessions List -->
        <ListView x:Name="SessionsListView" 
                  Grid.Row="1" 
                  SelectionMode="Single">
            <ListView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="12" Margin="0,0,0,8" Background="{ThemeResource CardBackgroundFillColorDefaultBrush}" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <!-- Table Icon -->
                        <FontIcon Grid.Column="0" 
                                 Glyph="&#xE8F1;" 
                                 FontSize="24" 
                                 Foreground="{ThemeResource SystemAccentColor}" 
                                 Margin="0,0,12,0"/>

                        <!-- Session Info -->
                        <StackPanel Grid.Column="1">
                            <TextBlock FontWeight="SemiBold" FontSize="16" Text="{Binding TableId}"/>
                            <TextBlock FontSize="14" Opacity="0.7" Margin="0,2,0,0" Text="{Binding ServerName}"/>
                            <TextBlock FontSize="12" Opacity="0.6" Margin="0,2,0,0" Text="{Binding StartTimeText}"/>
                            <TextBlock FontSize="12" Opacity="0.6" Margin="0,2,0,0" Text="{Binding ItemsCountText}"/>
                        </StackPanel>

                        <!-- Duration -->
                        <StackPanel Grid.Column="2" HorizontalAlignment="Right">
                            <TextBlock FontWeight="SemiBold" FontSize="14" HorizontalAlignment="Right" Text="{Binding DurationText}"/>
                            <TextBlock FontSize="12" Opacity="0.7" HorizontalAlignment="Right" Margin="0,2,0,0" Text="{Binding TotalText}"/>
                        </StackPanel>
                    </Grid>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Actions -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
            <Button x:Name="ResumeButton" 
                    Content="Resume Selected" 
                    Click="ResumeButton_Click" 
                    Margin="0,0,8,0"
                    IsEnabled="False"/>
            <Button x:Name="CloseAllButton" 
                    Content="Close All Sessions" 
                    Click="CloseAllButton_Click" 
                    Margin="0,0,8,0"
                    Style="{ThemeResource AccentButtonStyle}"/>
        </StackPanel>
    </Grid>
</ContentDialog>
